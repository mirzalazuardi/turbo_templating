<div class="mb-4" role="search" aria-label="Search and filter table">
  <% html = { class: "mb-2 flex space-x-2", role: "search" } %>
  <% html[:data] = { turbo: true, turbo_frame: @result_frame_id } if @result_frame_id.present? %>
  <%= search_form_for @ransack, url: request.path, method: :get, html: html do |f| %>
    <% @columns.each do |col| %>
      <%= f.label search_field_name(col), "Search by #{col.to_s.humanize}", class: "sr-only" %>
      <%= f.search_field search_field_name(col),
          placeholder: col.to_s.humanize,
          class: "shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",
          "aria-label": "Search by #{col.to_s.humanize}" %>
    <% end %>
    <%= f.submit "Search", class: "ml-2 px-4 py-2 bg-blue-600 text-white rounded focus:ring-2 focus:ring-offset-2 focus:ring-blue-500", "aria-label": "Submit search" %>
  <% end %>
</div>
<table class="min-w-full divide-y divide-gray-200 mb-4" role="table" aria-label="Data table">
  <thead class="bg-gray-50">
    <tr role="row">
      <% @columns.each do |col| %>
        <th scope="col" class="px-8 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" role="columnheader">
          <%= sort_link(@ransack, col, col.to_s.humanize) %>
        </th>
      <% end %>
      <% if @show_actions %>
        <th scope="col" class="px-8 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" role="columnheader">
          Actions
        </th>
      <% end %>
    </tr>
  </thead>
  <tbody class="<%= tbody_classes %>">
    <% if @records.any? %>
      <% @records.each do |record| %>
        <tr role="row" id="<%= "#{record.class.name.underscore}_#{record.id}" %>" class="<%= row_classes %>" data-controller="fade">
          <% @columns.each do |col| %>
            <td class="px-8 py-4" role="cell">
              <%= display_value(record, col) %>
            </td>
          <% end %>
          <% if @show_actions %>
            <td class="px-8 py-4 text-sm font-medium" role="cell">
              <div class="flex items-center gap-3">
                <% if can_edit?(record) %>
                  <%= link_to edit_url(record), class: "text-indigo-600 hover:text-indigo-900 font-medium", title: "Edit", data: { turbo_frame: "modal" } do %>
                    <%= edit_icon %>
                  <% end %>
                <% end %>
                <% if can_destroy?(record) %>
                  <%= button_to destroy_url(record), method: :delete, class: "text-red-600 hover:text-red-900 font-medium", title: "Delete", data: { turbo_confirm: "Are you sure?", action: "fade#destroy" }, form: { data: { turbo_frame: @result_frame_id } } do %>
                    <%= delete_icon %>
                  <% end %>
                <% end %>
              </div>
            </td>
          <% end %>
        </tr>
      <% end %>
    <% else %>
      <tr role="row">
        <td colspan="<%= @show_actions ? @columns.length + 1 : @columns.length %>" class="px-8 py-8 text-center text-gray-500" role="cell">
          No records found
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<nav aria-label="Pagination navigation">
  <%= render PagyTailwindComponent.new(pagy: @pagy, turbo_frame: @result_frame_id) if @pagy %>
</nav>
